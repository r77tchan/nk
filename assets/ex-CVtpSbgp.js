import{w as K,a as n,o as e}from"./chunk-NL6KNZEE-p2j07Jdd.js";function Q({}){return[{title:"抽出"},{name:"description",content:"データ抽出ページ"}]}const U=K(function(){const[f,B]=n.useState(""),[g,A]=n.useState(""),[M,T]=n.useState(""),[E,D]=n.useState(""),[c,C]=n.useState("text"),[i,S]=n.useState("text"),[b,W]=n.useState(1),[y,q]=n.useState(9999),[N,z]=n.useState(1),[j,P]=n.useState(9999),[v,R]=n.useState(1),[w,_]=n.useState(1),G=async t=>{var s;const r=(s=t.target.files)==null?void 0:s[0];if(!r)return;T(r.name);const o=await r.arrayBuffer(),a=new TextDecoder("shift-jis").decode(o);B(a)},H=async t=>{var s;const r=(s=t.target.files)==null?void 0:s[0];if(!r)return;D(r.name);const o=await r.arrayBuffer(),a=new TextDecoder("shift-jis").decode(o);A(a)},I=t=>{const r=[];let o="",a=!1;for(let s=0;s<t.length;s++){const l=t[s];l==='"'?a&&t[s+1]==='"'?(o+='"',s++):a=!a:l===","&&!a?(r.push(o),o=""):o+=l}return r.push(o),r.map(s=>s.startsWith('"')&&s.endsWith('"')?s.slice(1,-1):s)},k=(t,r,o,a,s)=>{const l=t.split(/\r?\n/),p=[];if(r==="text"){const x=Math.max(0,o-1),d=Math.min(a,9999);for(const h of l){const F=h.slice(x,Math.min(d,h.length));(F!==""||h!=="")&&p.push({original:h,key:F})}return{list:p}}for(const x of l){if(!x)continue;const d=I(x);if(s<1||s>d.length)return{list:[],error:"指定された列は存在しません"};p.push({original:x,key:d[s-1]})}return{list:p}},m=n.useMemo(()=>k(f,c,b,y,v),[f,c,b,y,v]),u=n.useMemo(()=>k(g,i,N,j,w),[g,i,N,j,w]),J=n.useMemo(()=>{if(m.error||u.error)return[];const t=m.list,r=new Set(u.list.map(a=>a.key.trim()));if(r.size===0)return t.map(a=>a.original);const o=[];for(const a of t)r.has(a.key.trim())&&o.push(a.original);return o},[m,u]);return e.jsxs("main",{className:"pt-16 p-4 container mx-auto space-y-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"抽出"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 grid-rows-[auto_1fr]",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"areaA",className:"font-bold",children:"抽出対象"}),e.jsxs("label",{className:"block w-fit mt-1 text-sm cursor-pointer",children:[e.jsx("span",{className:"inline-block file:mr-2 rounded border border-gray-300 bg-gray-50 px-2 py-1 text-gray-700 hover:bg-gray-100",children:"ファイルを選択"}),e.jsx("input",{type:"file",accept:"text/*",onChange:G,className:"hidden"})]}),e.jsx("div",{className:"mt-1 text-sm break-words whitespace-pre-wrap",children:M||"選択されていません"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"typeA",value:"text",checked:c==="text",onChange:()=>C("text"),className:"mr-1"}),"テキスト"]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"typeA",value:"csv",checked:c==="csv",onChange:()=>C("csv"),className:"mr-1"}),"csv"]}),c==="text"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"number",value:b,onChange:t=>W(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1,max:9999}),e.jsx("span",{children:"~"}),e.jsx("input",{type:"number",value:y,onChange:t=>q(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1,max:9999})]}):e.jsx("input",{type:"number",value:v,onChange:t=>R(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1})]}),m.error&&e.jsx("div",{className:"text-sm text-red-600 mt-1",children:m.error})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"areaB",className:"font-bold",children:"抽出単語"}),e.jsxs("label",{className:"block w-fit mt-1 text-sm cursor-pointer",children:[e.jsx("span",{className:"inline-block file:mr-2 rounded border border-gray-300 bg-gray-50 px-2 py-1 text-gray-700 hover:bg-gray-100",children:"ファイルを選択"}),e.jsx("input",{type:"file",accept:"text/*",onChange:H,className:"hidden"})]}),e.jsx("div",{className:"mt-1 text-sm break-words whitespace-pre-wrap",children:E||"選択されていません"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"typeB",value:"text",checked:i==="text",onChange:()=>S("text"),className:"mr-1"}),"テキスト"]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"typeB",value:"csv",checked:i==="csv",onChange:()=>S("csv"),className:"mr-1"}),"csv"]}),i==="text"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"number",value:N,onChange:t=>z(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1,max:9999}),e.jsx("span",{children:"~"}),e.jsx("input",{type:"number",value:j,onChange:t=>P(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1,max:9999})]}):e.jsx("input",{type:"number",value:w,onChange:t=>_(Number(t.target.value)),className:"border w-20 px-1 py-0.5 text-right",min:1})]}),u.error&&e.jsx("div",{className:"text-sm text-red-600 mt-1",children:u.error})]}),e.jsx("textarea",{id:"areaA",rows:2,value:f,onChange:t=>B(t.target.value),wrap:"off",className:"w-full border p-2 rounded mt-1 overflow-x-auto whitespace-pre col-start-1 row-start-2 font-mono"}),e.jsx("textarea",{id:"areaB",rows:2,value:g,onChange:t=>A(t.target.value),wrap:"off",className:"w-full border p-2 rounded mt-1 overflow-x-auto whitespace-pre col-start-2 row-start-2 font-mono"})]}),e.jsx("ul",{className:"list-disc pl-6 overflow-x-auto whitespace-pre font-mono",children:J.map((t,r)=>e.jsx("li",{className:"whitespace-pre",children:t},r))})]})});export{U as default,Q as meta};
